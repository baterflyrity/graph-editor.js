<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Graph editor example</title>
	<!--jQuery-->
	<script src="dependencies/jquery-3.4.1.min.js"></script>
	
	<!--Semantic-UI-->
	<link rel="stylesheet" href="dependencies/semantic-ui/semantic.css"/>
	<script src="dependencies/semantic-ui/semantic.js"></script>
	
	<!--Vis.js Network-->
	<script type="text/javascript" src="dependencies/vis-network.js"></script>
	
	<!--Graph Editor-->
	<link rel="stylesheet" type="text/css" href="style.css">
	<script type="text/javascript" src="main.js"></script>
</head>
<body>
</body>
<script>
	$(function () {
		//All ids must be string!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
		//Create graph in container 'body'.
		ge = GraphEditor('body');
		//Create node display style.
		ge.SetElementStyle('greenNode', 'node', Object.assign({}, ge.GetElementStyle('defaultNode'), {color: 'green'})); //Just copied defaultNode style and changed color.
		ge.SetElementStyle('redNode', 'node', Object.assign({}, ge.GetElementStyle('defaultNode'), {color: 'red'}));
		//Create editable property from predefined class.
		ge.SetElementProperty('title', 'select', 'Пример select', 'stav', {course: 'Курс', stav: 'Став', volume: 'Объем', cost: 'Цена', vol1: 'Объем 1'});
		ge.SetElementProperty('customTitle', 'customMultiSelect', 'Пример customMultiSelect', {value:false,options: ['a', 'b', 'c']});
		//Create node type with defined style and property. It has no label, so no binding would automatically happen.
		ge.SetElementType('titledNode', 'node', 'Признак', 'Выбираемое название', 'green', ['title'], ['greenNode']);
		//This node type will have dynamic select, defined by element value as array of strings.
		ge.SetElementType('customTitledNode', 'node', 'Признак (зависимый)', 'Динамическое название', 'red', ['label', 'customTitle'], ['redNode']);
		//Create nodes and edges (generate random id).
		ge.SetElement('a', 'defaultNode');
		ge.SetElement('b', 'defaultNode', {label: 'Узел2'});
		ge.SetElement('d', 'customTitledNode', {
			label: 'dynamic', customTitle: {
				value: ['1', '6'],
				options: ['item 0', 'item 1', 'item 2', 'item 3', 'item 4', 'item 5', 'item 6', 'item 7', 'item 8', 'item 9']
			}
		});
		ge.SetElement(GraphEditor.GenerateID(), 'defaultEdge', {}, {from: 'a', to: 'b'});
		ge.SetElement(GraphEditor.GenerateID(), 'defaultEdge', {}, {from: 'a', to: 'c'});
		ge.SetElement(GraphEditor.GenerateID(), 'defaultEdge', {}, {from: 'c', to: 'd'});
		//Update options on titledNode changed. Subscribe before setting node c to init d by initiating c.
		ge.onSetElement.Subscribe(function (element) {
			//Handle titledNode by it's ID.
			if (element.elementID === 'c') {
				//Find node d.
				let d = ge.GetElement('d');
				//Node d has customTitle property, so it's value defines it's options.
				d.elementPropertiesValues.customTitle = {
					options: [1, 2, 3].map(i => element.elementPropertiesValues.title + " " + i),//Selected in node c option plus 1, 2 or 3 number. Number 1 will be preselected.
					value: false, //Any non-true value treated as first option. If no options, '' value is used.
				};
				//Update node d. Sorry, no special method now, use constructor.
				ge.SetElement('d', d.elementTypeID, d.elementPropertiesValues, d.elementClassArguments, d.nestedGraph, d.cachedTypedPropertiesValues);
			}
			//Type of this event is 'pipe', so must return element.
			return element;
		});
		//Now create node c and it will update node d.
		ge.SetElement('c', 'titledNode', {title: 'stav'});

	});
</script>
</html>
